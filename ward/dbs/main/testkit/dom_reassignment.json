{
  "uri": "xo.58753544223475875324",
  "aux": "testkit",
  "kind": "js",
  "name": "reassign elements to export",
  "notes": "requites <x-testkit-draggable>",
  "media": "\n        lain.rom.testkit_reassign = (dom_new) => {\n            const dom_current_map = new Map();       \n            document.querySelectorAll('[data-set]').forEach(element => {\n                const dataSetValue = element.getAttribute('data-set');\n                if (dom_current_map.has(dataSetValue)) {\n                    const existingElement = dom_current_map.get(dataSetValue);\n                    existingElement.parentElement.removeChild(existingElement);\n                }\n                dom_current_map.set(dataSetValue, element);\n            });\n            const newDataSets = new Set(dom_new.map(elementInfo => elementInfo.attributes['data-set']));\n            dom_new.forEach(elementInfo => {\n                const entry_domset_value = elementInfo.attributes['data-set'];\n                const element = dom_current_map.get(entry_domset_value);\n                if (element) {\n                    Object.entries(elementInfo.attributes).forEach(([attrName, attrValue]) => {\n                        if (attrName !== 'data-step') {\n                            element.setAttribute(attrName, attrValue);\n                        }\n                    });\n                    if (element.tagName.toLowerCase() === 'x-testkit-draggable') {\n                        const draggedContent = element.querySelector('.dragged_content');\n                        if (draggedContent) {\n                            draggedContent.style.width = elementInfo.misc.width + 'px';\n                            draggedContent.style.height = (elementInfo.misc.height - 30) + 'px';\n                        }\n                        Object.entries(elementInfo.misc).forEach(([attrName, attrValue]) => {\n                            if (attrName !== 'width' && attrName !== 'height') {\n                                element.style[attrName] = attrValue;\n                            }\n                        });\n                    } else {\n                        Object.entries(elementInfo.misc).forEach(([attrName, attrValue]) => {\n                            element.style[attrName] = attrValue;\n                        });\n                    }\n                    if (element.style.display === 'none' && element.style.pointerEvents === 'none') {\n                        const dataSet = parseInt(entry_domset_value, 10);\n                        const cacheIndex = lain.cache.findIndex(item => item.domset === dataSet);\n                        if (cacheIndex !== -1) {\n                            lain.cache[cacheIndex].hidden = true;\n                        }\n                    }\n                    dom_current_map.delete(entry_domset_value);\n                    const parentElement = element.parentElement;\n                    if (parentElement.tagName.toLowerCase() === 'body') {\n                        if (parentElement.firstChild) {\n                            parentElement.insertBefore(element, parentElement.firstChild);\n                        } else {\n                            parentElement.appendChild(element);\n                        }\n                    } else {\n                        parentElement.appendChild(element);\n                    }\n                }\n            });\n            dom_current_map.forEach((element, domset) => {\n                if (!newDataSets.has(domset)) {\n                    console.log(newDataSets, domset, element);\n                    var dataSet = parseInt(domset, 10);\n                    var cacheIndex = lain.cache.findIndex(function(item) { return item.domset === dataSet; });\n                    if (cacheIndex !== -1) {   \n                        lain.rom.removeCacheItem({ index: cacheIndex });\n                    } else if (element.parentElement) {\n                        element.parentElement.removeChild(element);\n                    }\n                }\n            });\n            console.log(\"dom reassigned\");\n        };\n        "
}